import{n as e,r as t,t as n}from"./chunk-DM4wYaYk.mjs";import{a as r,c as i,i as a,n as o,o as s,r as c,s as l,t as u}from"./github-CIvZWh8R.mjs";import{n as d,t as f}from"./message_builder-DyBejjpU.mjs";import"./validate-CpJ-oDAO.mjs";import{parseRules as p,t as m}from"./rules.mjs";import{constants as h,promises as g}from"fs";import*as _ from"os";import v,{EOL as y}from"os";import"@actions/http-client";import{ProxyAgent as b,fetch as x}from"undici";import{legacyRestEndpointMethods as S}from"@octokit/plugin-rest-endpoint-methods";import{paginateRest as C}from"@octokit/plugin-paginate-rest";import"@actions/http-client/lib/auth";import"@actions/exec";import{createActionAuth as w}from"@octokit/auth-action";function T(e){return e==null?``:typeof e==`string`||e instanceof String?e:JSON.stringify(e)}function E(e){return Object.keys(e).length?{title:e.title,file:e.file,line:e.startLine,endLine:e.endLine,col:e.startColumn,endColumn:e.endColumn}:{}}var D=e((()=>{}));function O(e,t,n){let r=new M(e,t,n);process.stdout.write(r.toString()+_.EOL)}function k(e){return T(e).replace(/%/g,`%25`).replace(/\r/g,`%0D`).replace(/\n/g,`%0A`)}function A(e){return T(e).replace(/%/g,`%25`).replace(/\r/g,`%0D`).replace(/\n/g,`%0A`).replace(/:/g,`%3A`).replace(/,/g,`%2C`)}var j,M,N=e((()=>{D(),j=`::`,M=class{constructor(e,t,n){e||=`missing.command`,this.command=e,this.properties=t,this.message=n}toString(){let e=j+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=` `;let t=!0;for(let n in this.properties)if(this.properties.hasOwnProperty(n)){let r=this.properties[n];r&&(t?t=!1:e+=`,`,e+=`${n}=${A(r)}`)}}return e+=`${j}${k(this.message)}`,e}}})),P=e((()=>{K()})),F,I,L,R,z,B,V=e((()=>{F=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},{access:I,appendFile:L,writeFile:R}=g,z=`GITHUB_STEP_SUMMARY`,B=class{constructor(){this._buffer=``}filePath(){return F(this,void 0,void 0,function*(){if(this._filePath)return this._filePath;let e=process.env[z];if(!e)throw Error(`Unable to find environment variable for $${z}. Check if your runtime environment supports job summaries.`);try{yield I(e,h.R_OK|h.W_OK)}catch{throw Error(`Unable to access summary file: '${e}'. Check if the file has correct read/write permissions.`)}return this._filePath=e,this._filePath})}wrap(e,t,n={}){let r=Object.entries(n).map(([e,t])=>` ${e}="${t}"`).join(``);return t?`<${e}${r}>${t}</${e}>`:`<${e}${r}>`}write(e){return F(this,void 0,void 0,function*(){let t=!!e?.overwrite,n=yield this.filePath();return yield(t?R:L)(n,this._buffer,{encoding:`utf8`}),this.emptyBuffer()})}clear(){return F(this,void 0,void 0,function*(){return this.emptyBuffer().write({overwrite:!0})})}stringify(){return this._buffer}isEmptyBuffer(){return this._buffer.length===0}emptyBuffer(){return this._buffer=``,this}addRaw(e,t=!1){return this._buffer+=e,t?this.addEOL():this}addEOL(){return this.addRaw(y)}addCodeBlock(e,t){let n=Object.assign({},t&&{lang:t}),r=this.wrap(`pre`,this.wrap(`code`,e),n);return this.addRaw(r).addEOL()}addList(e,t=!1){let n=t?`ol`:`ul`,r=e.map(e=>this.wrap(`li`,e)).join(``),i=this.wrap(n,r);return this.addRaw(i).addEOL()}addTable(e){let t=e.map(e=>{let t=e.map(e=>{if(typeof e==`string`)return this.wrap(`td`,e);let{header:t,data:n,colspan:r,rowspan:i}=e,a=t?`th`:`td`,o=Object.assign(Object.assign({},r&&{colspan:r}),i&&{rowspan:i});return this.wrap(a,n,o)}).join(``);return this.wrap(`tr`,t)}).join(``),n=this.wrap(`table`,t);return this.addRaw(n).addEOL()}addDetails(e,t){let n=this.wrap(`details`,this.wrap(`summary`,e)+t);return this.addRaw(n).addEOL()}addImage(e,t,n){let{width:r,height:i}=n||{},a=Object.assign(Object.assign({},r&&{width:r}),i&&{height:i}),o=this.wrap(`img`,null,Object.assign({src:e,alt:t},a));return this.addRaw(o).addEOL()}addHeading(e,t){let n=`h${t}`,r=[`h1`,`h2`,`h3`,`h4`,`h5`,`h6`].includes(n)?n:`h1`,i=this.wrap(r,e);return this.addRaw(i).addEOL()}addSeparator(){let e=this.wrap(`hr`,null);return this.addRaw(e).addEOL()}addBreak(){let e=this.wrap(`br`,null);return this.addRaw(e).addEOL()}addQuote(e,t){let n=Object.assign({},t&&{cite:t}),r=this.wrap(`blockquote`,e,n);return this.addRaw(r).addEOL()}addLink(e,t){let n=this.wrap(`a`,e,{href:t});return this.addRaw(n).addEOL()}},new B})),H=e((()=>{v.platform(),v.arch()}));function U(e){process.exitCode=G.Failure,W(e)}function W(e,t={}){O(`error`,E(t),e instanceof Error?e.toString():e)}var G,K=e((()=>{N(),D(),P(),V(),H(),(function(e){e[e.Success=0]=`Success`,e[e.Failure=1]=`Failure`})(G||={})}));function q(){let e=process.env.HTTP_PROXY||process.env.http_proxy;if(e)return new b(e);let t=process.env.HTTPS_PROXY||process.env.https_proxy;if(t)return new b(t)}function J(){return process.env.GITHUB_API_URL||`https://api.github.com`}var Y,X,Z,Q=e((()=>{i(),Y={authStrategy:w,baseUrl:J(),userAgent:`octokit-action.js/0.0.0-development`},X=async function(e,t){return await x(e,{dispatcher:q(),...t})},Z=l.plugin(C,S).defaults(function(e){return{...Y,...e,request:{fetch:X,...e.request}}})})),$=n(((e,n)=>{K(),s(),Q(),c(),d(),m();async function i(){try{let e=r,t=new Z,n=await o(t),i=e.issue.number,s=await u(t),c=[];process.env.INPUT_ADDITIONAL_RULES&&(c=p(process.env.INPUT_ADDITIONAL_RULES)),await a(t,i,n,new f(`# :tada: Happy commit!
{{#messages}}- {{&.}}
{{/messages}}`,{},c).build({commitIds:s,prNum:i}))}catch(e){e instanceof Error?U(`Unexpected error: ${e.message}`):U(`Unexpected error: ${e}`)}}t.main===n&&i().then()}));export default $();export{};
//# sourceMappingURL=index.mjs.map